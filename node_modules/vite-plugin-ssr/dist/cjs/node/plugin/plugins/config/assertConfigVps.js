"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkConfigVps = exports.getConfigVps = void 0;
// We import from node/utils.ts insead of node/plugin/utils.ts because this file is loaded by the server runtime
const utils_1 = require("../../../../node/utils");
function checkConfigVps(configVps) {
    (0, utils_1.assert)((0, utils_1.isObject)(configVps));
    {
        const prop = 'disableAutoFullBuild';
        if (!(0, utils_1.hasProp)(configVps, prop, 'boolean') && !(0, utils_1.hasProp)(configVps, prop, 'undefined'))
            return { prop, errMsg: 'should be a boolean' };
    }
    {
        const prop = 'includeAssetsImportedByServer';
        if (!(0, utils_1.hasProp)(configVps, prop, 'boolean') && !(0, utils_1.hasProp)(configVps, prop, 'undefined'))
            return { prop, errMsg: 'should be a boolean' };
    }
    {
        const prop = 'prerender';
        if (!(0, utils_1.hasProp)(configVps, prop, 'object') &&
            !(0, utils_1.hasProp)(configVps, prop, 'boolean') &&
            !(0, utils_1.hasProp)(configVps, prop, 'undefined'))
            return { prop, errMsg: 'should be an object or a boolean' };
    }
    const configVpsPrerender = configVps.prerender;
    if (typeof configVpsPrerender === 'object') {
        {
            const p = 'partial';
            if (!(0, utils_1.hasProp)(configVpsPrerender, p, 'boolean') && !(0, utils_1.hasProp)(configVpsPrerender, p, 'undefined'))
                return { prop: `prerender.${p}`, errMsg: 'should be a boolean' };
        }
        {
            const p = 'noExtraDir';
            if (!(0, utils_1.hasProp)(configVpsPrerender, p, 'boolean') && !(0, utils_1.hasProp)(configVpsPrerender, p, 'undefined'))
                return { prop: `prerender.${p}`, errMsg: 'should be a boolean' };
        }
        {
            const p = 'disableAutoRun';
            if (!(0, utils_1.hasProp)(configVpsPrerender, p, 'boolean') && !(0, utils_1.hasProp)(configVpsPrerender, p, 'undefined'))
                return { prop: `prerender.${p}`, errMsg: 'should be a boolean' };
        }
        {
            const p = 'parallel';
            if (!(0, utils_1.hasProp)(configVpsPrerender, p, 'boolean') &&
                !(0, utils_1.hasProp)(configVpsPrerender, p, 'number') &&
                !(0, utils_1.hasProp)(configVpsPrerender, p, 'undefined'))
                return { prop: `prerender.${p}`, errMsg: 'should be a boolean or a number' };
        }
    }
    return null;
}
exports.checkConfigVps = checkConfigVps;
async function getConfigVps(config) {
    const configVps = (await config.configVpsPromise);
    return configVps;
}
exports.getConfigVps = getConfigVps;
