"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getPageConfig = exports.getSourceFilePath = exports.getCodeFilePath = exports.getConfigValue = void 0;
const utils_1 = require("../utils");
// function getConfigValue(pageConfig: PageConfigData, configName: ConfigName): unknown
function getConfigValue(pageConfig, configName, type) {
    const configSource = pageConfig.configSources[configName];
    if (!configSource || isNullish(pageConfig, configName)) {
        return null;
    }
    const { configValue, configSrc } = configSource;
    (0, utils_1.assertUsage)(typeof configValue === type, `${configSrc} has an invalid type \`${typeof configValue}\`: is should be a ${type} instead`);
    return configValue;
}
exports.getConfigValue = getConfigValue;
function getCodeFilePath(pageConfig, configName) {
    const configSource = pageConfig.configSources[configName];
    if (!configSource || isNullish(pageConfig, configName)) {
        return null;
    }
    if (configSource.codeFilePath2 !== null) {
        return configSource.codeFilePath2;
    }
    const { configValue, configSrc } = configSource;
    (0, utils_1.assertUsage)(typeof configValue === 'string', `${configSrc} has an invalid type \`${typeof configValue}\`: it should be a \`string\` instead`);
    (0, utils_1.assertUsage)(false, `${configSrc} has an invalid value \`${configValue}\`: it should be a file path instead`);
}
exports.getCodeFilePath = getCodeFilePath;
function getSourceFilePath(pageConfig, configName) {
    const configSource = pageConfig.configSources[configName];
    if (!configSource || isNullish(pageConfig, configName)) {
        return null;
    }
    return configSource.configSrc;
}
exports.getSourceFilePath = getSourceFilePath;
function isNullish(pageConfig, configName) {
    const configSource = pageConfig.configSources[configName];
    if (!configSource)
        return true;
    const { codeFilePath2, configValue } = configSource;
    if (codeFilePath2)
        return false;
    return configValue === null || configValue === undefined;
}
function getPageConfig(pageId, pageConfigs) {
    const pageConfig = pageConfigs.find((p) => p.pageId2 === pageId);
    (0, utils_1.assert)(pageConfigs.length > 0);
    (0, utils_1.assert)(pageConfig);
    return pageConfig;
}
exports.getPageConfig = getPageConfig;
